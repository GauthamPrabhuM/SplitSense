services:
  # Full-stack app (FastAPI + Next.js frontend) using Docker
  - type: web
    name: splitsense
    env: docker
    plan: free  # Free tier - 750 hours/month, spins down after 15 min inactivity
    region: oregon  # Choose closest region (oregon, frankfurt, singapore, mumbai)
    dockerfilePath: ./Dockerfile
    dockerContext: .
    healthCheckPath: /api/health
    envVars:
      - key: ENVIRONMENT
        value: production
      - key: CORS_ORIGINS
        value: https://splitsense.onrender.com
      - key: FRONTEND_URL
        value: https://splitsense.onrender.com
      - key: BASE_CURRENCY
        value: USD
      - key: MASK_SENSITIVE_DATA
        value: "true"
      - key: LOCAL_ONLY
        value: "false"
      # IMPORTANT: Set these in Render dashboard as SECRET environment variables:
      # - SPLITWISE_CLIENT_ID (mark as secret)
      # - SPLITWISE_CLIENT_SECRET (mark as secret)
      # - SPLITWISE_REDIRECT_URI=https://splitsense.onrender.com/auth/callback
